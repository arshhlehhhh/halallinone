{"remainingRequest":"C:\\Users\\Ashley Lau\\Documents\\GitHub\\halallinone-prod\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Ashley Lau\\Documents\\GitHub\\halallinone-prod\\src\\views\\ForgetPassword.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"C:\\Users\\Ashley Lau\\Documents\\GitHub\\halallinone-prod\\src\\views\\ForgetPassword.vue","mtime":1605424293218},{"path":"C:\\Users\\Ashley Lau\\Documents\\GitHub\\halallinone-prod\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Ashley Lau\\Documents\\GitHub\\halallinone-prod\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\Ashley Lau\\Documents\\GitHub\\halallinone-prod\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\Ashley Lau\\Documents\\GitHub\\halallinone-prod\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Ashley Lau\\Documents\\GitHub\\halallinone-prod\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Ashley Lau\\Documents\\GitHub\\halallinone-prod\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLmZvcmdvdFBhc3N3b3JkIHsNCiAgLnRpdGxlIHsNCiAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICAgIG1hcmdpbi10b3A6IDMwcHg7DQogICAgfQ0KICAgIC5zcGFjaW5nIHsNCiAgICAgIHBhZGRpbmc6IDEwcHg7DQogICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgICBtYXJnaW46NTBweCAwIDEwMHB4IDA7DQoNCiAgICB9DQogICAgLmNhcmQtdGl0bGUsIC5jYXJkLXRleHQgew0KICAgICAgICB0ZXh0LWFsaWduOmNlbnRlcjsNCiAgICAgICAgbWFyZ2luLWJvdHRvbToyMHB4Ow0KICAgIH0NCn0NCg=="},{"version":3,"sources":["ForgetPassword.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"ForgetPassword.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n    <b-row class=\"forgotPassword\">\r\n        <b-col md=\"2\" class=\"green\"></b-col>\r\n        <b-col>\r\n          <br>\r\n          <b-alert show variant=\"success\" v-if=\"success\" class=\"text-center\">{{ success }}</b-alert>\r\n        <div class=\"title\">\r\n            <img src=\"../assets/logo.png\">\r\n            <!-- <h1>Forgot your Password?</h1> -->\r\n        </div>\r\n        <!-- Problem Section -->\r\n        <div class=\"spacing\">\r\n            <b-card title=\"Forgot your Password?\" style=\"max-width: 50%;\">\r\n                <b-card-text>\r\n                    Don't worry about it! Just enter your email here so you can reset your password and explore all the delicious halal food once more.\r\n                </b-card-text>\r\n                <b-form v-on:submit.prevent=\"sendEmail()\">\r\n                    <b-form-group label-for=\"email\">\r\n                        <b-form-input id=\"email\" v-model=\"email\" type=\"email\" placeholder=\"Email\" required=\"required\"></b-form-input>\r\n                    </b-form-group>\r\n                    <b-button type=\"submit\" variant=\"success\" style=\"width:100%;\">Reset your Password</b-button>\r\n                </b-form>\r\n            </b-card>\r\n        </div>\r\n        </b-col>\r\n        <b-col md=\"2\" class=\"green\"></b-col>\r\n    </b-row>\r\n</template>\r\n<style lang=\"scss\">\r\n.forgotPassword {\r\n  .title {\r\n      text-align: center;\r\n      margin-top: 30px;\r\n    }\r\n    .spacing {\r\n      padding: 10px;\r\n      display: flex;\r\n      justify-content: center;\r\n      margin:50px 0 100px 0;\r\n\r\n    }\r\n    .card-title, .card-text {\r\n        text-align:center;\r\n        margin-bottom:20px;\r\n    }\r\n}\r\n</style>\r\n<script>\r\nimport emailjs from 'emailjs-com'\r\nimport generator from 'generate-password'\r\nimport Vue from 'vue'\r\nimport axios from 'axios'\r\nexport default {\r\n  data () {\r\n    return {\r\n      email: '',\r\n      userName: '',\r\n      success: ''\r\n    }\r\n  },\r\n  methods: {\r\n    //  1. use session's email and username to populate\r\n    // 2. find a random generator\r\n    // 3. set the random generated pw to the the one sending for email\r\n    // 4. hash the  random generated pw then update\r\n    sendEmail (e) {\r\n      // retrieve email input\r\n      var emailInput = this.email\r\n      // generate pw\r\n      var plainTextPw = generator.generate({\r\n        length: 10,\r\n        numbers: true\r\n      })\r\n      // call axios get using email\r\n      const emailUrl = 'https://wad2-hallallinone.et.r.appspot.com/user/get/email=' + emailInput\r\n      axios.get(emailUrl).then((response) => {\r\n        if (response.status === 200) {\r\n          this.userName = response.data.User[0].username\r\n          emailjs.init('user_glh56R2pIXKnq8Xg9mNJi')\r\n          emailjs.send('service_yklx8g8', 'template_5myj1hr', {\r\n            to_name: this.userName,\r\n            password: plainTextPw,\r\n            to_email: emailInput\r\n          })\r\n            .then((result) => {\r\n              console.log(result)\r\n              console.log('SUCCESS!', result.status, result.text)\r\n              this.success = 'Email sent! Please check your email to change your password!'\r\n              this.email = ''\r\n              // generate sha 256 hash\r\n              var cryptoObject = Vue.CryptoJS.SHA256(plainTextPw).toString()\r\n              // setup to push\r\n              var updateUserName = this.userName\r\n              const urlUpdateDB = 'https://wad2-hallallinone.et.r.appspot.com/user/changepassword'\r\n              const auth = { username: updateUserName, password: cryptoObject }\r\n              // set up axios post\r\n              axios.post(urlUpdateDB, auth).then((response) => {\r\n                if (response.status === 201) {\r\n                  console.log('pw updated in db!')\r\n                }\r\n              }, function (err) {\r\n                console.log('err', err)\r\n              })\r\n            }, (error) => {\r\n              console.log('FAILED...', error)\r\n            })\r\n        }\r\n      }, function (err) {\r\n        console.log('err', err)\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}