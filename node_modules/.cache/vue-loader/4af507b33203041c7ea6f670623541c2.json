{"remainingRequest":"C:\\Users\\Ashley Lau\\Documents\\GitHub\\halallinone\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Ashley Lau\\Documents\\GitHub\\halallinone\\src\\views\\Settings.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Ashley Lau\\Documents\\GitHub\\halallinone\\src\\views\\Settings.vue","mtime":1605374709686},{"path":"C:\\Users\\Ashley Lau\\Documents\\GitHub\\halallinone\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Ashley Lau\\Documents\\GitHub\\halallinone\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Ashley Lau\\Documents\\GitHub\\halallinone\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Ashley Lau\\Documents\\GitHub\\halallinone\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnDQppbXBvcnQgVnVlIGZyb20gJ3Z1ZScNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAnU2V0dGluZ3MnLA0KICBjb21wb25lbnRzOiB7DQogIH0sDQogIGRhdGEgKCkgew0KICAgIHJldHVybiB7DQogICAgICByZXNldFBhc3N3b3JkOiB7DQogICAgICAgIE9sZFBhc3N3b3JkOiAnJywNCiAgICAgICAgTmV3UGFzc3dvcmQ6ICcnLA0KICAgICAgICBDb25maXJtUGFzc3dvcmQ6ICcnDQogICAgICB9LA0KICAgICAgZXJyb3I6ICcnLA0KICAgICAgc3VjY2VzczogJycNCiAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICByZXNldCAoKSB7DQogICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLiRzZXNzaW9uLmV4aXN0cygpKQ0KICAgICAgLy8gY29uc29sZS5sb2codGhpcy4kc2Vzc2lvbi5nZXQoJ3VzZXJuYW1lJykpDQogICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnJlc2V0UGFzc3dvcmQuT2xkUGFzc3dvcmQpDQogICAgICB2YXIgTmV3UGFzc3dvcmQgPSB0aGlzLnJlc2V0UGFzc3dvcmQuTmV3UGFzc3dvcmQNCiAgICAgIHZhciBDb25maXJtUGFzc3dvcmQgPSB0aGlzLnJlc2V0UGFzc3dvcmQuQ29uZmlybVBhc3N3b3JkDQogICAgICBpZiAoTmV3UGFzc3dvcmQgIT09IENvbmZpcm1QYXNzd29yZCkgew0KICAgICAgICB0aGlzLmVycm9yID0gJ1lvdXIgTmV3IFBhc3N3b3JkIGRvZXMgbm90IG1hdGNoIHlvdXIgQ29uZmlybWVkIFBhc3N3b3JkIScNCiAgICAgIH0NCiAgICAgIHZhciBvbGRjcnlwdG9PYmplY3QgPSBWdWUuQ3J5cHRvSlMuU0hBMjU2KHRoaXMucmVzZXRQYXNzd29yZC5PbGRQYXNzd29yZCkudG9TdHJpbmcoKQ0KICAgICAgdmFyIG5ld2NyeXB0b09iamVjdCA9IFZ1ZS5DcnlwdG9KUy5TSEEyNTYodGhpcy5yZXNldFBhc3N3b3JkLk5ld1Bhc3N3b3JkKS50b1N0cmluZygpDQogICAgICAvLyBjb25zb2xlLmxvZyhvbGRjcnlwdG9PYmplY3QpDQogICAgICAvLyBjb25zb2xlLmxvZyhuZXdjcnlwdG9PYmplY3QpDQogICAgICBheGlvcw0KICAgICAgICAuZ2V0KCdodHRwczovL3dhZDItaGFsbGFsbGlub25lLmV0LnIuYXBwc3BvdC5jb20vdXNlci9nZXQvdXNlcm5hbWU9JyArIHRoaXMuJHNlc3Npb24uZ2V0KCd1c2VybmFtZScpKQ0KICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsNCiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXNwb25zZS5kYXRhKQ0KICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlc3BvbnNlLmRhdGEuVXNlclswXS5wYXNzd29yZCkNCiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5Vc2VyWzBdLnBhc3N3b3JkID09PSBvbGRjcnlwdG9PYmplY3QpIHsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdZRVMnKQ0KICAgICAgICAgICAgaWYgKE5ld1Bhc3N3b3JkID09PSBDb25maXJtUGFzc3dvcmQpIHsNCiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3llc3llcycpDQogICAgICAgICAgICAgIGNvbnN0IHVybCA9ICdodHRwczovL3dhZDItaGFsbGFsbGlub25lLmV0LnIuYXBwc3BvdC5jb20vdXNlci9jaGFuZ2VwYXNzd29yZCcNCiAgICAgICAgICAgICAgY29uc3QgYXV0aCA9IHsgdXNlcm5hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCd1c2VybmFtZScpLCBwYXNzd29yZDogbmV3Y3J5cHRvT2JqZWN0IH0NCiAgICAgICAgICAgICAgYXhpb3MucG9zdCh1cmwsIGF1dGgpLnRoZW4oKHJlc3BvbnNlKSA9PiB7DQogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzcG9uc2Uuc3RhdHVzKQ0KICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLmRhdGEpDQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgICB0aGlzLnN1Y2Nlc3MgPSAnUGFzc3dvcmQgQ2hhbmdlIFN1Y2Nlc3NmdWwhJw0KICAgICAgICAgICAgICB0aGlzLmVycm9yID0gJycNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdGhpcy5lcnJvciA9ICdZb3VyIE9sZCBQYXNzd29yZCB5b3UgaGF2ZSBlbnRlcmVkIGlzIGluY29ycmVjdC4nDQogICAgICAgICAgfQ0KICAgICAgICB9KQ0KICAgICAgcmV0dXJuIHRoaXMuZXJyb3INCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["Settings.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6DA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Settings.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <b-row class=\"settings\">\r\n    <b-col md=\"2\" class=\"green\"></b-col>\r\n    <b-col>\r\n      <div class=\"title\">\r\n        <img src=\"../assets/logo.png\">\r\n      </div>\r\n      <div class=\"password-content\">\r\n        <b-alert> {{error}} </b-alert>\r\n        <div>\r\n          <h2>Reset Password</h2>\r\n          <h6> Need to reset your password? Fill in the form here so you can reset your password and explore all the\r\n            delicious halal food once more.</h6>\r\n          <b-form v-on:submit.prevent=\"reset()\">\r\n            <b-row class=\"my-1\">\r\n              <b-col sm=\"2\">\r\n                <label for=\"OldPassword\">Old Password:</label>\r\n              </b-col>\r\n              <b-col sm=\"10\">\r\n                <b-form-input id=\"OldPassword\" placeholder=\"Old Password\" v-model=\"resetPassword.OldPassword\">\r\n                </b-form-input>\r\n              </b-col>\r\n            </b-row>\r\n            <b-row class=\"my-1\">\r\n              <b-col sm=\"2\">\r\n                <label for=\"NewPassword\">New Password:</label>\r\n              </b-col>\r\n              <b-col sm=\"10\">\r\n                <b-form-input id=\"NewPassword\" placeholder=\"New Password\" v-model=\"resetPassword.NewPassword\">\r\n                </b-form-input>\r\n              </b-col>\r\n            </b-row>\r\n            <b-row class=\"my-1\">\r\n              <b-col sm=\"2\">\r\n                <label for=\"ConfirmPassword\">Confirm New Password: </label>\r\n              </b-col>\r\n              <b-col sm=\"10\">\r\n                <b-form-input id=\"Confirm Password\" placeholder=\"Confirm New Password\"\r\n                  v-model=\"resetPassword.ConfirmPassword\"></b-form-input>\r\n              </b-col>\r\n            </b-row>\r\n            <div>\r\n              <b-alert show variant=\"danger\" v-if=\"error\" class=\"text-center\">{{ error }}</b-alert>\r\n            </div>\r\n            <div>\r\n              <b-alert show variant=\"success\" v-if=\"success\" class=\"text-center\">{{ success }}</b-alert>\r\n            </div>\r\n            <b-button variant=\"success\" style=\"width:100%;\" type=\"submit\">Reset your Password</b-button>\r\n          </b-form>\r\n        <h5> Have you forgotten your old password? No worries! Just click here to reset your password through email!</h5>\r\n        <b-button v-on:submit=\"emailreset()\" style=\"background-color: #155C2D ; width:100%\">Reset through email!</b-button>\r\n        <br>\r\n        <br>\r\n      </div>\r\n      </div>\r\n    </b-col>\r\n    <b-col md=\"2\" class=\"green\"></b-col>\r\n  </b-row>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport Vue from 'vue'\r\n\r\nexport default {\r\n  name: 'Settings',\r\n  components: {\r\n  },\r\n  data () {\r\n    return {\r\n      resetPassword: {\r\n        OldPassword: '',\r\n        NewPassword: '',\r\n        ConfirmPassword: ''\r\n      },\r\n      error: '',\r\n      success: ''\r\n    }\r\n  },\r\n  methods: {\r\n    reset () {\r\n      // console.log(this.$session.exists())\r\n      // console.log(this.$session.get('username'))\r\n      // console.log(this.resetPassword.OldPassword)\r\n      var NewPassword = this.resetPassword.NewPassword\r\n      var ConfirmPassword = this.resetPassword.ConfirmPassword\r\n      if (NewPassword !== ConfirmPassword) {\r\n        this.error = 'Your New Password does not match your Confirmed Password!'\r\n      }\r\n      var oldcryptoObject = Vue.CryptoJS.SHA256(this.resetPassword.OldPassword).toString()\r\n      var newcryptoObject = Vue.CryptoJS.SHA256(this.resetPassword.NewPassword).toString()\r\n      // console.log(oldcryptoObject)\r\n      // console.log(newcryptoObject)\r\n      axios\r\n        .get('https://wad2-hallallinone.et.r.appspot.com/user/get/username=' + this.$session.get('username'))\r\n        .then((response) => {\r\n          // console.log(response.data)\r\n          // console.log(response.data.User[0].password)\r\n          if (response.data.User[0].password === oldcryptoObject) {\r\n            console.log('YES')\r\n            if (NewPassword === ConfirmPassword) {\r\n              console.log('yesyes')\r\n              const url = 'https://wad2-hallallinone.et.r.appspot.com/user/changepassword'\r\n              const auth = { username: this.$session.get('username'), password: newcryptoObject }\r\n              axios.post(url, auth).then((response) => {\r\n                // console.log(response.status)\r\n                console.log(response.data)\r\n              }\r\n              )\r\n              this.success = 'Password Change Successful!'\r\n              this.error = ''\r\n            }\r\n          } else {\r\n            this.error = 'Your Old Password you have entered is incorrect.'\r\n          }\r\n        })\r\n      return this.error\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}