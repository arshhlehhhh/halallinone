{"remainingRequest":"C:\\Users\\Ashley Lau\\Documents\\GitHub\\halallinone-prod\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Ashley Lau\\Documents\\GitHub\\halallinone-prod\\src\\views\\ForgetPassword.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Ashley Lau\\Documents\\GitHub\\halallinone-prod\\src\\views\\ForgetPassword.vue","mtime":1605424293218},{"path":"C:\\Users\\Ashley Lau\\Documents\\GitHub\\halallinone-prod\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Ashley Lau\\Documents\\GitHub\\halallinone-prod\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Ashley Lau\\Documents\\GitHub\\halallinone-prod\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgZW1haWxqcyBmcm9tICdlbWFpbGpzLWNvbScNCmltcG9ydCBnZW5lcmF0b3IgZnJvbSAnZ2VuZXJhdGUtcGFzc3dvcmQnDQppbXBvcnQgVnVlIGZyb20gJ3Z1ZScNCmltcG9ydCBheGlvcyBmcm9tICdheGlvcycNCmV4cG9ydCBkZWZhdWx0IHsNCiAgZGF0YSAoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGVtYWlsOiAnJywNCiAgICAgIHVzZXJOYW1lOiAnJywNCiAgICAgIHN1Y2Nlc3M6ICcnDQogICAgfQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgLy8gIDEuIHVzZSBzZXNzaW9uJ3MgZW1haWwgYW5kIHVzZXJuYW1lIHRvIHBvcHVsYXRlDQogICAgLy8gMi4gZmluZCBhIHJhbmRvbSBnZW5lcmF0b3INCiAgICAvLyAzLiBzZXQgdGhlIHJhbmRvbSBnZW5lcmF0ZWQgcHcgdG8gdGhlIHRoZSBvbmUgc2VuZGluZyBmb3IgZW1haWwNCiAgICAvLyA0LiBoYXNoIHRoZSAgcmFuZG9tIGdlbmVyYXRlZCBwdyB0aGVuIHVwZGF0ZQ0KICAgIHNlbmRFbWFpbCAoZSkgew0KICAgICAgLy8gcmV0cmlldmUgZW1haWwgaW5wdXQNCiAgICAgIHZhciBlbWFpbElucHV0ID0gdGhpcy5lbWFpbA0KICAgICAgLy8gZ2VuZXJhdGUgcHcNCiAgICAgIHZhciBwbGFpblRleHRQdyA9IGdlbmVyYXRvci5nZW5lcmF0ZSh7DQogICAgICAgIGxlbmd0aDogMTAsDQogICAgICAgIG51bWJlcnM6IHRydWUNCiAgICAgIH0pDQogICAgICAvLyBjYWxsIGF4aW9zIGdldCB1c2luZyBlbWFpbA0KICAgICAgY29uc3QgZW1haWxVcmwgPSAnaHR0cHM6Ly93YWQyLWhhbGxhbGxpbm9uZS5ldC5yLmFwcHNwb3QuY29tL3VzZXIvZ2V0L2VtYWlsPScgKyBlbWFpbElucHV0DQogICAgICBheGlvcy5nZXQoZW1haWxVcmwpLnRoZW4oKHJlc3BvbnNlKSA9PiB7DQogICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkgew0KICAgICAgICAgIHRoaXMudXNlck5hbWUgPSByZXNwb25zZS5kYXRhLlVzZXJbMF0udXNlcm5hbWUNCiAgICAgICAgICBlbWFpbGpzLmluaXQoJ3VzZXJfZ2xoNTZSMnBJWEtucThYZzltTkppJykNCiAgICAgICAgICBlbWFpbGpzLnNlbmQoJ3NlcnZpY2VfeWtseDhnOCcsICd0ZW1wbGF0ZV81bXlqMWhyJywgew0KICAgICAgICAgICAgdG9fbmFtZTogdGhpcy51c2VyTmFtZSwNCiAgICAgICAgICAgIHBhc3N3b3JkOiBwbGFpblRleHRQdywNCiAgICAgICAgICAgIHRvX2VtYWlsOiBlbWFpbElucHV0DQogICAgICAgICAgfSkNCiAgICAgICAgICAgIC50aGVuKChyZXN1bHQpID0+IHsNCiAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KQ0KICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU1VDQ0VTUyEnLCByZXN1bHQuc3RhdHVzLCByZXN1bHQudGV4dCkNCiAgICAgICAgICAgICAgdGhpcy5zdWNjZXNzID0gJ0VtYWlsIHNlbnQhIFBsZWFzZSBjaGVjayB5b3VyIGVtYWlsIHRvIGNoYW5nZSB5b3VyIHBhc3N3b3JkIScNCiAgICAgICAgICAgICAgdGhpcy5lbWFpbCA9ICcnDQogICAgICAgICAgICAgIC8vIGdlbmVyYXRlIHNoYSAyNTYgaGFzaA0KICAgICAgICAgICAgICB2YXIgY3J5cHRvT2JqZWN0ID0gVnVlLkNyeXB0b0pTLlNIQTI1NihwbGFpblRleHRQdykudG9TdHJpbmcoKQ0KICAgICAgICAgICAgICAvLyBzZXR1cCB0byBwdXNoDQogICAgICAgICAgICAgIHZhciB1cGRhdGVVc2VyTmFtZSA9IHRoaXMudXNlck5hbWUNCiAgICAgICAgICAgICAgY29uc3QgdXJsVXBkYXRlREIgPSAnaHR0cHM6Ly93YWQyLWhhbGxhbGxpbm9uZS5ldC5yLmFwcHNwb3QuY29tL3VzZXIvY2hhbmdlcGFzc3dvcmQnDQogICAgICAgICAgICAgIGNvbnN0IGF1dGggPSB7IHVzZXJuYW1lOiB1cGRhdGVVc2VyTmFtZSwgcGFzc3dvcmQ6IGNyeXB0b09iamVjdCB9DQogICAgICAgICAgICAgIC8vIHNldCB1cCBheGlvcyBwb3N0DQogICAgICAgICAgICAgIGF4aW9zLnBvc3QodXJsVXBkYXRlREIsIGF1dGgpLnRoZW4oKHJlc3BvbnNlKSA9PiB7DQogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAxKSB7DQogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncHcgdXBkYXRlZCBpbiBkYiEnKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycikgew0KICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnInLCBlcnIpDQogICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9LCAoZXJyb3IpID0+IHsNCiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0ZBSUxFRC4uLicsIGVycm9yKQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgfQ0KICAgICAgfSwgZnVuY3Rpb24gKGVycikgew0KICAgICAgICBjb25zb2xlLmxvZygnZXJyJywgZXJyKQ0KICAgICAgfSkNCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["ForgetPassword.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ForgetPassword.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n    <b-row class=\"forgotPassword\">\r\n        <b-col md=\"2\" class=\"green\"></b-col>\r\n        <b-col>\r\n          <br>\r\n          <b-alert show variant=\"success\" v-if=\"success\" class=\"text-center\">{{ success }}</b-alert>\r\n        <div class=\"title\">\r\n            <img src=\"../assets/logo.png\">\r\n            <!-- <h1>Forgot your Password?</h1> -->\r\n        </div>\r\n        <!-- Problem Section -->\r\n        <div class=\"spacing\">\r\n            <b-card title=\"Forgot your Password?\" style=\"max-width: 50%;\">\r\n                <b-card-text>\r\n                    Don't worry about it! Just enter your email here so you can reset your password and explore all the delicious halal food once more.\r\n                </b-card-text>\r\n                <b-form v-on:submit.prevent=\"sendEmail()\">\r\n                    <b-form-group label-for=\"email\">\r\n                        <b-form-input id=\"email\" v-model=\"email\" type=\"email\" placeholder=\"Email\" required=\"required\"></b-form-input>\r\n                    </b-form-group>\r\n                    <b-button type=\"submit\" variant=\"success\" style=\"width:100%;\">Reset your Password</b-button>\r\n                </b-form>\r\n            </b-card>\r\n        </div>\r\n        </b-col>\r\n        <b-col md=\"2\" class=\"green\"></b-col>\r\n    </b-row>\r\n</template>\r\n<style lang=\"scss\">\r\n.forgotPassword {\r\n  .title {\r\n      text-align: center;\r\n      margin-top: 30px;\r\n    }\r\n    .spacing {\r\n      padding: 10px;\r\n      display: flex;\r\n      justify-content: center;\r\n      margin:50px 0 100px 0;\r\n\r\n    }\r\n    .card-title, .card-text {\r\n        text-align:center;\r\n        margin-bottom:20px;\r\n    }\r\n}\r\n</style>\r\n<script>\r\nimport emailjs from 'emailjs-com'\r\nimport generator from 'generate-password'\r\nimport Vue from 'vue'\r\nimport axios from 'axios'\r\nexport default {\r\n  data () {\r\n    return {\r\n      email: '',\r\n      userName: '',\r\n      success: ''\r\n    }\r\n  },\r\n  methods: {\r\n    //  1. use session's email and username to populate\r\n    // 2. find a random generator\r\n    // 3. set the random generated pw to the the one sending for email\r\n    // 4. hash the  random generated pw then update\r\n    sendEmail (e) {\r\n      // retrieve email input\r\n      var emailInput = this.email\r\n      // generate pw\r\n      var plainTextPw = generator.generate({\r\n        length: 10,\r\n        numbers: true\r\n      })\r\n      // call axios get using email\r\n      const emailUrl = 'https://wad2-hallallinone.et.r.appspot.com/user/get/email=' + emailInput\r\n      axios.get(emailUrl).then((response) => {\r\n        if (response.status === 200) {\r\n          this.userName = response.data.User[0].username\r\n          emailjs.init('user_glh56R2pIXKnq8Xg9mNJi')\r\n          emailjs.send('service_yklx8g8', 'template_5myj1hr', {\r\n            to_name: this.userName,\r\n            password: plainTextPw,\r\n            to_email: emailInput\r\n          })\r\n            .then((result) => {\r\n              console.log(result)\r\n              console.log('SUCCESS!', result.status, result.text)\r\n              this.success = 'Email sent! Please check your email to change your password!'\r\n              this.email = ''\r\n              // generate sha 256 hash\r\n              var cryptoObject = Vue.CryptoJS.SHA256(plainTextPw).toString()\r\n              // setup to push\r\n              var updateUserName = this.userName\r\n              const urlUpdateDB = 'https://wad2-hallallinone.et.r.appspot.com/user/changepassword'\r\n              const auth = { username: updateUserName, password: cryptoObject }\r\n              // set up axios post\r\n              axios.post(urlUpdateDB, auth).then((response) => {\r\n                if (response.status === 201) {\r\n                  console.log('pw updated in db!')\r\n                }\r\n              }, function (err) {\r\n                console.log('err', err)\r\n              })\r\n            }, (error) => {\r\n              console.log('FAILED...', error)\r\n            })\r\n        }\r\n      }, function (err) {\r\n        console.log('err', err)\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}